const dash_button = require('node-dash-button');
const execSync = require('child_process').execSync;
// Dashボタンのアドレス(コピーしたMACアドレスをここに入力)
const dash = dash_button('44:65:0d:8a:0f:4f', null, null, 'all');

// ボタンをクリックしたときのアクション
// クリックしてから数秒遅延します。

execSync(`say ${'ゲームスタート'}`);

dash.on('detected', function () {
  console.log("detected");
  var participants = ["しゃもじ","まあじい","きんぐ","ちょこ","しんぼり","くのおる"];
  var punisher = participants[ Math.floor( Math.random() * participants.length)];
  execSync(`say ${punisher + "が"}`);

  var guilties = participants;
  guilties.some(function(v, i){
    if (v==[punisher]) guilties.splice(i,1);
  });
  var guilty = guilties[ Math.floor( Math.random() * guilties.length)];
  execSync(`say ${guilty + "に"}`);

  var punishTypes = ["しっぺ","かたぱん","でこぴん","タイキック"];
  var punishType = punishTypes[ Math.floor( Math.random() * punishTypes.length)];
  execSync(`say ${punishType}`);
});
